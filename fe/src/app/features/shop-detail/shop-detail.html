<div class="container py-4">
    <!-- Shop Header -->
    <div class="card shop-header-card shadow-sm rounded-4 mb-4 border-0" *ngIf="shop">
        <div class="card-body p-4">
            <div class="d-flex flex-column flex-md-row gap-4 align-items-center align-items-md-start">
                <img [src]="shop.logoUrl || 'assets/images/default-shop.png'" alt="{{shop.shopName}}"
                    class="rounded-circle object-fit-cover shop-avatar">

                <div class="flex-grow-1 text-center text-md-start">
                    <h2 class="fw-bold mb-1">{{shop.shopName}}</h2>
                    <p class="text-muted mb-2"><i class="bi bi-geo-alt me-1"></i>{{shop.address}}</p>
                    <p class="mb-3 text-secondary small">{{shop.description}}</p>

                    <div class="d-flex gap-3 justify-content-center justify-content-md-start text-muted small">
                        <span><i class="bi bi-box-seam me-1"></i>{{shop.totalProducts || 0}} Sản phẩm</span>
                        <span><i class="bi bi-star-fill text-warning me-1"></i>{{shop.rating || 0}} Đánh giá</span>
                        <span><i class="bi bi-calendar-check me-1"></i>Tham gia: {{shop.createdAt |
                            date:'dd/MM/yyyy'}}</span>
                    </div>
                </div>

                <div class="d-flex gap-2">
                    <button class="btn btn-primary rounded-pill px-4">
                        <i class="bi bi-chat-dots me-1"></i> Chat Ngay
                    </button>
                    <!-- <button class="btn btn-outline-secondary rounded-circle">
                        <i class="bi bi-share"></i>
                    </button> -->
                </div>
            </div>
        </div>
    </div>

    <!-- Filter/Sort Bar -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h4 class="fw-bold mb-0">Danh sách sản phẩm</h4>
        <div class="d-flex gap-2">
            <!-- Add sort logic here if needed -->
            <select class="form-select border-0 shadow-sm bg-light" style="width: auto;">
                <option value="newest">Mới nhất</option>
                <option value="price_asc">Giá tăng dần</option>
                <option value="price_desc">Giá giảm dần</option>
            </select>
        </div>
    </div>

    <!-- Product Grid -->
    <div *ngIf="isLoading" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <div *ngIf="!isLoading && products.length === 0" class="text-center py-5">
        <img src="assets/images/empty-box.png" alt="Empty" width="100" class="mb-3 opacity-50">
        <p class="text-muted">Shop chưa có sản phẩm nào.</p>
    </div>

    <div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 g-3 mb-4"
        *ngIf="!isLoading && products.length > 0">
        <div class="col" *ngFor="let product of products">
            <div class="card h-100 border-0 shadow-sm rounded-4 product-card cursor-pointer"
                [routerLink]="['/product', product.id]">
                <div class="product-img-wrapper rounded-top-4">
                    <img [src]="product.imageUrl" class="w-100 h-100 object-fit-cover" alt="{{product.name}}">
                    <div class="badge-sale" *ngIf="product.salePrice && product.salePrice < product.price">
                        -{{ ((product.price - product.salePrice) / product.price * 100) | number:'1.0-0' }}%
                    </div>
                </div>
                <div class="card-body p-3 d-flex flex-column">
                    <h6 class="card-title fw-semibold text-dark mb-1 line-clamp-2" style="min-height: 2.5em;">
                        {{product.name}}</h6>
                    <div class="mt-auto">
                        <div class="d-flex align-items-center gap-2 mb-2">
                            <span class="fw-bold text-primary">{{ (product.salePrice || product.price) |
                                currency:'VND':'symbol':'1.0-0':'vi-VN' }}</span>
                            <span class="text-decoration-line-through text-muted small"
                                *ngIf="product.salePrice && product.salePrice < product.price">
                                {{ product.price | currency:'VND':'symbol':'1.0-0':'vi-VN' }}
                            </span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center small">
                            <span class="text-warning"><i class="bi bi-star-fill"></i> {{product.rating || 5}}</span>
                            <span class="text-muted">Đã bán {{product.sold || 0}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pagination -->
    <div class="d-flex justify-content-center" *ngIf="totalPages > 1">
        <nav>
            <ul class="pagination shadow-sm rounded-pill overflow-hidden">
                <li class="page-item" [class.disabled]="page === 0">
                    <button class="page-link border-0" (click)="onPageChange(page - 1)">
                        <i class="bi bi-chevron-left"></i>
                    </button>
                </li>
                <li class="page-item disabled"><span class="page-link border-0 text-muted">Trang {{page + 1}} /
                        {{totalPages}}</span></li>
                <li class="page-item" [class.disabled]="page >= totalPages - 1">
                    <button class="page-link border-0" (click)="onPageChange(page + 1)">
                        <i class="bi bi-chevron-right"></i>
                    </button>
                </li>
            </ul>
        </nav>
    </div>
</div>